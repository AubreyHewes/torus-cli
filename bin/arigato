#!/usr/bin/env node
// vim: set ft=javascript;
'use strict';

var yargs = require('yargs');

var log = require('../lib/util/log').get('main');
var cmds = require('../lib/cmds');

function main () {

  // TODO: Separate error processing and returning a non zero exit code.
  //
  // Push responsibility for determing error code up and have the Command
  // return the proper exit code.
  cmds.load().then(() => {
    return cmds.process(yargs.argv);
  }).catch((err) => {
    log.error('An error happened..');
    console.error((err instanceof Error) ? err.stack : err);
    process.exit(1);
  });
}

if (require.main === module) {
  main();
}
