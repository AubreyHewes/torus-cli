#!/usr/bin/env node
'use strict';

var _ = require('lodash');
var yargs = require('yargs');

var log = require('../util/log').get('main');
var cmds = require('../cmds');

function main () {
  var argv = yargs.argv;

  if (argv._.length === 0) {
    argv._ = ['help'];
  }

  var cmd = argv._[0].toLowerCase();
  argv._.shift();

  if (!cmds[cmd]) {
    log.error('Invalid Command Provided: ', cmd);
    cmd = 'help';
  }

  var exitCode = 0;
  try {
    exitCode = cmds[cmd].command(argv, cmds);
  } catch (err) {
    log.error('Error', err)
    exitCode = 1;
  }

  return exitCode;
}

if (require.main === module) {
  process.exit(main());
}
